ORG 0000H
LJMP MAIN

ORG 0023H
LJMP SERIAL

S9600 EQU -3
S4800 EQU -6
S2400 EQU -12
S1200 EQU -24

ORG 0030H
MAIN: MOV TMOD, #00100000B

MOV TH1, S9600

MOV SCON, #01000000B
MOV IE, #10010000B
SETB TR1
REPEAT: ACALL TRANSMIT
ACALL RECEIVE
SJMP REPEAT

ORG 0070H
SERIAL: JNB TI, REC
MOV SBUF, R7
CLR TI
RETI

REC: MOV R6, SBUF
CLR RI
RETI

ORG 00A0H
TRANSMIT: MOV R5, A 
MOV A, #00010000B
CPL A
ANL A, SCON
MOV SCON, A
MOV A, R5
MOV R7, A
RET

ORG 00C0H
RECEIVE: MOV A, #00010000B
ORL A, SCON
MOV SCON, A
MOV A, R6
RET

END
